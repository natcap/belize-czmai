---
title: "Post-processing & summarizing the outputs from the Habitat Risk Assessment (HRA) model using the habitat maps from 2016 and all the scenarios"
author: "Jade Delevaux"
created: September 2022
output:
  html_document:
    df_print: paged
---

To run this script, install the packages below

```{r Install packages needed for this script}
library(sf)
library(foreign)
library(raster)
library(rgdal)
library(dplyr)
library(exactextractr)
library(ggplot2)
library(gridExtra)
library(cowplot)
library(rgeos)
library(sp)
library(ggpubr)
library(tigris)
library(maptools)
library(reshape)
```

Note: The working directory (WD) needs to reflect your local machine. Use the function "Find and replace" in R studio to replace the root of the working directory by your local path (e.g., "E:/GreenFin") to apply this script. 

# A/ Coral: Combine all the scenarios into 1 dataframe

We import the dataframe summarizing the risk onto coral by scenario (2016,2022,2025):

```{r Import the coral dataframes & split them by km2 and pct}
cor_risk_2016 <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/2016/risk_summary_corals.csv") 
cor_risk_2016_km2 <- cor_risk_2016[,c(1:9)]
cor_risk_2016_pct <- cor_risk_2016[,c(1:5,10:13)]
cor_risk_2020 <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/2020/risk_summary_corals.csv") 
cor_risk_2020_km2 <- cor_risk_2020[,c(1:9)]
cor_risk_2020_pct <- cor_risk_2020[,c(1:5,10:13)]
cor_risk_2025 <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/2025/risk_summary_corals.csv")
cor_risk_2025_km2 <- cor_risk_2025[,c(1:9)]
cor_risk_2025_pct <- cor_risk_2025[,c(1:5,10:13)]
```

Lets build the dataframe for the km2 unit: 

First, we rename the columns & flip the dataframe for the 2016 scenario

```{r Melt the 2016 dataframe in km2}
names(cor_risk_2016_km2) 
names(cor_risk_2016_km2)[6] <- "No Risk"
names(cor_risk_2016_km2)[7] <- "Low"
names(cor_risk_2016_km2)[8] <- "Medium" 
names(cor_risk_2016_km2)[9] <- "High" 
cor_risk_2016_km2$Year <- "2016" 
names(cor_risk_2016_km2) 
mcor_risk_2016 <- melt(cor_risk_2016_km2, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(mcor_risk_2016) 
names(mcor_risk_2016)[6] <- "Risk" 
names(mcor_risk_2016)[7] <- "km2" 
names(mcor_risk_2016)
```

Then, we rename the columns & flip the dataframe for the 2020 scenario

```{r Melt the 2020 dataframe in km2}
names(cor_risk_2020_km2) 
names(cor_risk_2020_km2)[6] <- "No Risk"
names(cor_risk_2020_km2)[7] <- "Low"
names(cor_risk_2020_km2)[8] <- "Medium" 
names(cor_risk_2020_km2)[9] <- "High" 
cor_risk_2020_km2$Year <- "2020" 
names(cor_risk_2020_km2) 
mcor_risk_2020 <- melt(cor_risk_2020_km2, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(mcor_risk_2020) 
names(mcor_risk_2020)[6] <- "Risk" 
names(mcor_risk_2020)[7] <- "km2" 
names(mcor_risk_2020)
```

Then, we rename the columns & flip the dataframe for the 2025 scenario

```{r Melt the 2025 dataframe in km2}
names(cor_risk_2025_km2) 
names(cor_risk_2025_km2)[6] <- "No Risk"
names(cor_risk_2025_km2)[7] <- "Low"
names(cor_risk_2025_km2)[8] <- "Medium" 
names(cor_risk_2025_km2)[9] <- "High" 
cor_risk_2025_km2$Year <- "2025" 
names(cor_risk_2025_km2) 
mcor_risk_2025 <- melt(cor_risk_2025_km2, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(mcor_risk_2025) 
names(mcor_risk_2025)[6] <- "Risk" 
names(mcor_risk_2025)[7] <- "km2" 
names(mcor_risk_2025)
```

We combine the 3 scenarios:

```{r Combine and export the summary results in km2}
cor_risk_all <- rbind(mcor_risk_2016, mcor_risk_2020, mcor_risk_2025) 
names(cor_risk_all) # Write the csv file 
write.csv(cor_risk_all, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_km2_by_scenario_corals.csv")), row.names = F)
```

Lets build the dataframe for the percent unit: 

First, we rename the columns & flip the dataframe for the 2016 scenario

```{r Melt the 2016 dataframe in pct}
names(cor_risk_2016_pct) 
names(cor_risk_2016_pct)[6] <- "No Risk"
names(cor_risk_2016_pct)[7] <- "Low"
names(cor_risk_2016_pct)[8] <- "Medium" 
names(cor_risk_2016_pct)[9] <- "High" 
cor_risk_2016_pct$Year <- "2016" 
names(cor_risk_2016_pct) 
mcor_risk_2016 <- melt(cor_risk_2016_pct, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(mcor_risk_2016) 
names(mcor_risk_2016)[6] <- "Risk" 
names(mcor_risk_2016)[7] <- "pct" 
names(mcor_risk_2016)
```

Then, we rename the columns & flip the dataframe for the 2020 scenario

```{r Melt the 2020 dataframe in pct}
names(cor_risk_2020_pct) 
names(cor_risk_2020_pct)[6] <- "No Risk"
names(cor_risk_2020_pct)[7] <- "Low"
names(cor_risk_2020_pct)[8] <- "Medium" 
names(cor_risk_2020_pct)[9] <- "High" 
cor_risk_2020_pct$Year <- "2020" 
names(cor_risk_2020_pct) 
mcor_risk_2020 <- melt(cor_risk_2020_pct, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(mcor_risk_2020) 
names(mcor_risk_2020)[6] <- "Risk" 
names(mcor_risk_2020)[7] <- "pct" 
names(mcor_risk_2020)
```

Then, we rename the columns & flip the dataframe for the 2025 scenario

```{r Melt the 2025 dataframe in pct}
names(cor_risk_2025_pct) 
names(cor_risk_2025_pct)[6] <- "No Risk"
names(cor_risk_2025_pct)[7] <- "Low"
names(cor_risk_2025_pct)[8] <- "Medium" 
names(cor_risk_2025_pct)[9] <- "High" 
cor_risk_2025_pct$Year <- "2025" 
names(cor_risk_2025_pct) 
mcor_risk_2025 <- melt(cor_risk_2025_pct, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(mcor_risk_2025) 
names(mcor_risk_2025)[6] <- "Risk" 
names(mcor_risk_2025)[7] <- "pct" 
names(mcor_risk_2025)
```

We combine the 3 scenarios:

```{r Combine and export the summary results in pct}
cor_risk_all <- rbind(mcor_risk_2016, mcor_risk_2020, mcor_risk_2025) 
names(cor_risk_all) # Write the csv file 
write.csv(cor_risk_all, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_pct_by_scenario_corals.csv")), row.names = F)
```

We completed this section so we can clear our working environment

```{r Clear the working environment}
rm(list = ls(all.names=TRUE))
```

# B/ Seagrass: Combine all the scenarios into 1 dataframe

We import the dataframe summarizing the risk onto seagrass by scenario (2016,2022,2025):

```{r Import the seagrass dataframes & split them by km2 and pct}
sgr_risk_2016 <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/2016/risk_summary_seagrass.csv") 
sgr_risk_2016_km2 <- sgr_risk_2016[,c(1:9)]
sgr_risk_2016_pct <- sgr_risk_2016[,c(1:5,10:13)]
sgr_risk_2020 <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/2020/risk_summary_seagrass.csv") 
sgr_risk_2020_km2 <- sgr_risk_2020[,c(1:9)]
sgr_risk_2020_pct <- sgr_risk_2020[,c(1:5,10:13)]
sgr_risk_2025 <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/2025/risk_summary_seagrass.csv")
sgr_risk_2025_km2 <- sgr_risk_2025[,c(1:9)]
sgr_risk_2025_pct <- sgr_risk_2025[,c(1:5,10:13)]
```

Lets build the dataframe for the km2 unit: 

First, we rename the columns & flip the dataframe for the 2016 scenario

```{r Melt the 2016 dataframe in km2}
names(sgr_risk_2016_km2) 
names(sgr_risk_2016_km2)[6] <- "No Risk"
names(sgr_risk_2016_km2)[7] <- "Low"
names(sgr_risk_2016_km2)[8] <- "Medium" 
names(sgr_risk_2016_km2)[9] <- "High" 
sgr_risk_2016_km2$Year <- "2016" 
names(sgr_risk_2016_km2) 
msgr_risk_2016 <- melt(sgr_risk_2016_km2, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(msgr_risk_2016) 
names(msgr_risk_2016)[6] <- "Risk" 
names(msgr_risk_2016)[7] <- "km2" 
names(msgr_risk_2016)
```

Then, we rename the columns & flip the dataframe for the 2020 scenario

```{r Melt the 2020 dataframe in km2}
names(sgr_risk_2020_km2) 
names(sgr_risk_2020_km2)[6] <- "No Risk"
names(sgr_risk_2020_km2)[7] <- "Low"
names(sgr_risk_2020_km2)[8] <- "Medium" 
names(sgr_risk_2020_km2)[9] <- "High" 
sgr_risk_2020_km2$Year <- "2020" 
names(sgr_risk_2020_km2) 
msgr_risk_2020 <- melt(sgr_risk_2020_km2, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(msgr_risk_2020) 
names(msgr_risk_2020)[6] <- "Risk" 
names(msgr_risk_2020)[7] <- "km2" 
names(msgr_risk_2020)
```

Then, we rename the columns & flip the dataframe for the 2025 scenario

```{r Melt the 2025 dataframe in km2}
names(sgr_risk_2025_km2) 
names(sgr_risk_2025_km2)[6] <- "No Risk"
names(sgr_risk_2025_km2)[7] <- "Low"
names(sgr_risk_2025_km2)[8] <- "Medium" 
names(sgr_risk_2025_km2)[9] <- "High" 
sgr_risk_2025_km2$Year <- "2025" 
names(sgr_risk_2025_km2) 
msgr_risk_2025 <- melt(sgr_risk_2025_km2, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(msgr_risk_2025) 
names(msgr_risk_2025)[6] <- "Risk" 
names(msgr_risk_2025)[7] <- "km2" 
names(msgr_risk_2025)
```

We combine the 3 scenarios:

```{r Combine and export the summary results in km2}
sgr_risk_all <- rbind(msgr_risk_2016, msgr_risk_2020, msgr_risk_2025) 
names(sgr_risk_all) # Write the csv file 
write.csv(sgr_risk_all, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_km2_by_scenario_seagrass.csv")), row.names = F)
```

Lets build the dataframe for the percent unit: 

First, we rename the columns & flip the dataframe for the 2016 scenario

```{r Melt the 2016 dataframe in pct}
names(sgr_risk_2016_pct) 
names(sgr_risk_2016_pct)[6] <- "No Risk"
names(sgr_risk_2016_pct)[7] <- "Low"
names(sgr_risk_2016_pct)[8] <- "Medium" 
names(sgr_risk_2016_pct)[9] <- "High" 
sgr_risk_2016_pct$Year <- "2016" 
names(sgr_risk_2016_pct) 
msgr_risk_2016 <- melt(sgr_risk_2016_pct, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(msgr_risk_2016) 
names(msgr_risk_2016)[6] <- "Risk" 
names(msgr_risk_2016)[7] <- "pct" 
names(msgr_risk_2016)
```

Then, we rename the columns & flip the dataframe for the 2020 scenario

```{r Melt the 2020 dataframe in pct}
names(sgr_risk_2020_pct) 
names(sgr_risk_2020_pct)[6] <- "No Risk"
names(sgr_risk_2020_pct)[7] <- "Low"
names(sgr_risk_2020_pct)[8] <- "Medium" 
names(sgr_risk_2020_pct)[9] <- "High" 
sgr_risk_2020_pct$Year <- "2020" 
names(sgr_risk_2020_pct) 
msgr_risk_2020 <- melt(sgr_risk_2020_pct, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(msgr_risk_2020) 
names(msgr_risk_2020)[6] <- "Risk" 
names(msgr_risk_2020)[7] <- "pct" 
names(msgr_risk_2020)
```

Then, we rename the columns & flip the dataframe for the 2025 scenario

```{r Melt the 2025 dataframe in pct}
names(sgr_risk_2025_pct) 
names(sgr_risk_2025_pct)[6] <- "No Risk"
names(sgr_risk_2025_pct)[7] <- "Low"
names(sgr_risk_2025_pct)[8] <- "Medium" 
names(sgr_risk_2025_pct)[9] <- "High" 
sgr_risk_2025_pct$Year <- "2025" 
names(sgr_risk_2025_pct) 
msgr_risk_2025 <- melt(sgr_risk_2025_pct, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(msgr_risk_2025) 
names(msgr_risk_2025)[6] <- "Risk" 
names(msgr_risk_2025)[7] <- "pct" 
names(msgr_risk_2025)
```

We combine the 3 scenarios:

```{r Combine and export the summary results in pct}
sgr_risk_all <- rbind(msgr_risk_2016, msgr_risk_2020, msgr_risk_2025) 
names(sgr_risk_all) # Write the csv file 
write.csv(sgr_risk_all, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_pct_by_scenario_seagrass.csv")), row.names = F)
```

We completed this section so we can clear our working environment

```{r Clear the working environment}
rm(list = ls(all.names=TRUE))
```

# C/ Mangroves: Combine all the scenarios into 1 dataframe

```{r Import the mangroves dataframes & split them by km2 and pct}
mgv_risk_2016 <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/2016/risk_summary_mangroves.csv") 
mgv_risk_2016_km2 <- mgv_risk_2016[,c(1:9)]
mgv_risk_2016_pct <- mgv_risk_2016[,c(1:5,10:13)]
mgv_risk_2020 <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/2020/risk_summary_mangroves.csv") 
mgv_risk_2020_km2 <- mgv_risk_2020[,c(1:9)]
mgv_risk_2020_pct <- mgv_risk_2020[,c(1:5,10:13)]
mgv_risk_2025 <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/2025/risk_summary_mangroves.csv")
mgv_risk_2025_km2 <- mgv_risk_2025[,c(1:9)]
mgv_risk_2025_pct <- mgv_risk_2025[,c(1:5,10:13)]
```

Lets build the dataframe for the km2 unit: 

First, we rename the columns & flip the dataframe for the 2016 scenario

```{r Melt the 2016 dataframe in km2}
names(mgv_risk_2016_km2) 
names(mgv_risk_2016_km2)[6] <- "No Risk"
names(mgv_risk_2016_km2)[7] <- "Low"
names(mgv_risk_2016_km2)[8] <- "Medium" 
names(mgv_risk_2016_km2)[9] <- "High" 
mgv_risk_2016_km2$Year <- "2016" 
names(mgv_risk_2016_km2) 
mmgv_risk_2016 <- melt(mgv_risk_2016_km2, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(mmgv_risk_2016) 
names(mmgv_risk_2016)[6] <- "Risk" 
names(mmgv_risk_2016)[7] <- "km2" 
names(mmgv_risk_2016)
```

Then, we rename the columns & flip the dataframe for the 2020 scenario

```{r Melt the 2020 dataframe in km2}
names(mgv_risk_2020_km2) 
names(mgv_risk_2020_km2)[6] <- "No Risk"
names(mgv_risk_2020_km2)[7] <- "Low"
names(mgv_risk_2020_km2)[8] <- "Medium" 
names(mgv_risk_2020_km2)[9] <- "High" 
mgv_risk_2020_km2$Year <- "2020" 
names(mgv_risk_2020_km2) 
mmgv_risk_2020 <- melt(mgv_risk_2020_km2, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(mmgv_risk_2020) 
names(mmgv_risk_2020)[6] <- "Risk" 
names(mmgv_risk_2020)[7] <- "km2" 
names(mmgv_risk_2020)
```

Then, we rename the columns & flip the dataframe for the 2025 scenario

```{r Melt the 2025 dataframe in km2}
names(mgv_risk_2025_km2) 
names(mgv_risk_2025_km2)[6] <- "No Risk"
names(mgv_risk_2025_km2)[7] <- "Low"
names(mgv_risk_2025_km2)[8] <- "Medium" 
names(mgv_risk_2025_km2)[9] <- "High" 
mgv_risk_2025_km2$Year <- "2025" 
names(mgv_risk_2025_km2) 
mmgv_risk_2025 <- melt(mgv_risk_2025_km2, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(mmgv_risk_2025) 
names(mmgv_risk_2025)[6] <- "Risk" 
names(mmgv_risk_2025)[7] <- "km2" 
names(mmgv_risk_2025)
```

We combine the 3 scenarios:

```{r Combine and export the summary results in km2}
mgv_risk_all <- rbind(mmgv_risk_2016, mmgv_risk_2020, mmgv_risk_2025) 
names(mgv_risk_all) # Write the csv file 
write.csv(mgv_risk_all, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_km2_by_scenario_mangroves.csv")), row.names = F)
```

Lets build the dataframe for the percent unit: 

First, we rename the columns & flip the dataframe for the 2016 scenario

```{r Melt the 2016 dataframe in pct}
names(mgv_risk_2016_pct) 
names(mgv_risk_2016_pct)[6] <- "No Risk"
names(mgv_risk_2016_pct)[7] <- "Low"
names(mgv_risk_2016_pct)[8] <- "Medium" 
names(mgv_risk_2016_pct)[9] <- "High" 
mgv_risk_2016_pct$Year <- "2016" 
names(mgv_risk_2016_pct) 
mmgv_risk_2016 <- melt(mgv_risk_2016_pct, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(mmgv_risk_2016) 
names(mmgv_risk_2016)[6] <- "Risk" 
names(mmgv_risk_2016)[7] <- "pct" 
names(mmgv_risk_2016)
```

Then, we rename the columns & flip the dataframe for the 2020 scenario

```{r Melt the 2020 dataframe in pct}
names(mgv_risk_2020_pct) 
names(mgv_risk_2020_pct)[6] <- "No Risk"
names(mgv_risk_2020_pct)[7] <- "Low"
names(mgv_risk_2020_pct)[8] <- "Medium" 
names(mgv_risk_2020_pct)[9] <- "High" 
mgv_risk_2020_pct$Year <- "2020" 
names(mgv_risk_2020_pct) 
mmgv_risk_2020 <- melt(mgv_risk_2020_pct, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(mmgv_risk_2020) 
names(mmgv_risk_2020)[6] <- "Risk" 
names(mmgv_risk_2020)[7] <- "pct" 
names(mmgv_risk_2020)
```

Then, we rename the columns & flip the dataframe for the 2025 scenario

```{r Melt the 2025 dataframe in pct}
names(mgv_risk_2025_pct) 
names(mgv_risk_2025_pct)[6] <- "No Risk"
names(mgv_risk_2025_pct)[7] <- "Low"
names(mgv_risk_2025_pct)[8] <- "Medium" 
names(mgv_risk_2025_pct)[9] <- "High" 
mgv_risk_2025_pct$Year <- "2025" 
names(mgv_risk_2025_pct) 
mmgv_risk_2025 <- melt(mgv_risk_2025_pct, id=c("cpu","cpu_name","cpu_nameo","habitat","Year")) 
str(mmgv_risk_2025) 
names(mmgv_risk_2025)[6] <- "Risk" 
names(mmgv_risk_2025)[7] <- "pct" 
names(mmgv_risk_2025)
```

We combine the 3 scenarios:

```{r Combine and export the summary results in pct}
mgv_risk_all <- rbind(mmgv_risk_2016, mmgv_risk_2020, mmgv_risk_2025) 
names(mgv_risk_all) # Write the csv file 
write.csv(mgv_risk_all, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_pct_by_scenario_mangroves.csv")), row.names = F)
```

We completed this section so we can clear our working environment

```{r Clear the working environment}
rm(list = ls(all.names=TRUE))
```

# D/ Create dataframes at Belize scale

Subset the full dataframe to extract the results for the entire country for each habitat type and for the two units (km2 and %): 

```{r Belize results for Coral in km2}
risk_df <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_km2_by_scenario_corals.csv")
risk_df$cpu <- as.factor(risk_df$cpu)
# select rows 10 = BZ 
target <- c('10')
bz_df <- risk_df[risk_df$cpu %in% target,] 
write.csv(bz_df, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_km2_by_scenario_corals_bz.csv")), row.names = F)
```

```{r Belize results for Coral in pct}
risk_df <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_pct_by_scenario_corals.csv")
risk_df$cpu <- as.factor(risk_df$cpu)
# select rows 10 = BZ 
target <- c('10')
bz_df <- risk_df[risk_df$cpu %in% target,] 
write.csv(bz_df, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_pct_by_scenario_corals_bz.csv")), row.names = F)
```

```{r Belize results for Seagrass in km2}
risk_df <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_km2_by_scenario_seagrass.csv")
risk_df$cpu <- as.factor(risk_df$cpu)
# select rows 10 = BZ 
target <- c('10')
bz_df <- risk_df[risk_df$cpu %in% target,] 
write.csv(bz_df, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_km2_by_scenario_seagrass_bz.csv")), row.names = F)
```

```{r Belize results for Seagrass in pct}
risk_df <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_pct_by_scenario_seagrass.csv")
risk_df$cpu <- as.factor(risk_df$cpu)
# select rows 10 = BZ 
target <- c('10')
bz_df <- risk_df[risk_df$cpu %in% target,] 
write.csv(bz_df, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_pct_by_scenario_seagrass_bz.csv")), row.names = F)
```

```{r Belize results for Mangroves in km2}
risk_df <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_km2_by_scenario_mangroves.csv")
risk_df$cpu <- as.factor(risk_df$cpu)
# select rows 10 = BZ 
target <- c('10')
bz_df <- risk_df[risk_df$cpu %in% target,] 
write.csv(bz_df, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_km2_by_scenario_mangroves_bz.csv")), row.names = F)
```

```{r Belize results for Mangroves in pct}
risk_df <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_pct_by_scenario_mangroves.csv")
risk_df$cpu <- as.factor(risk_df$cpu)
# select rows 10 = BZ 
target <- c('10')
bz_df <- risk_df[risk_df$cpu %in% target,] 
write.csv(bz_df, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_pct_by_scenario_mangroves_bz.csv")), row.names = F)
```

We completed this section so we can clear our working environment

```{r Clear the working environment}
rm(list = ls(all.names=TRUE))
```


# E/ Create dataframes at coastal planning units scale

Subset the full dataframe to extract the results for the coastal planning units for each habitat type and for the two units (km2 and %): 

```{r CPU results for Coral in km2}
risk_df <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_km2_by_scenario_corals.csv")
risk_df$cpu <- as.factor(risk_df$cpu)
# select rows 1-9 = CPU 
target <- c('1','2','3','4','5','6','7','8','9')
bz_df <- risk_df[risk_df$cpu %in% target,] 
bz_df$CPU <- paste(bz_df$cpu,bz_df$cpu_name,sep= "-")
bz_df <- bz_df[, c(1:2,8,3:7)]
write.csv(bz_df, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_km2_by_scenario_corals_cpu.csv")), row.names = F)
```

```{r CPU results for Coral in pct}
risk_df <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_pct_by_scenario_corals.csv")
risk_df$cpu <- as.factor(risk_df$cpu)
# select rows 1-9 = CPU 
target <- c('1','2','3','4','5','6','7','8','9')
bz_df <- risk_df[risk_df$cpu %in% target,] 
bz_df$CPU <- paste(bz_df$cpu,bz_df$cpu_name,sep= "-")
bz_df <- bz_df[, c(1:2,8,3:7)]
write.csv(bz_df, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_pct_by_scenario_corals_cpu.csv")), row.names = F)
```

```{r CPU results for Seagrass in km2}
risk_df <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_km2_by_scenario_seagrass.csv")
risk_df$cpu <- as.factor(risk_df$cpu)
# select rows 1-9 = CPU 
target <- c('1','2','3','4','5','6','7','8','9')
bz_df <- risk_df[risk_df$cpu %in% target,] 
bz_df$CPU <- paste(bz_df$cpu,bz_df$cpu_name,sep= "-")
bz_df <- bz_df[, c(1:2,8,3:7)]
write.csv(bz_df, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_km2_by_scenario_seagrass_cpu.csv")), row.names = F)
```

```{r CPU results for Seagrass in pct}
risk_df <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_pct_by_scenario_seagrass.csv")
risk_df$cpu <- as.factor(risk_df$cpu)
# select rows 1-9 = CPU 
target <- c('1','2','3','4','5','6','7','8','9')
bz_df <- risk_df[risk_df$cpu %in% target,] 
bz_df$CPU <- paste(bz_df$cpu,bz_df$cpu_name,sep= "-")
bz_df <- bz_df[, c(1:2,8,3:7)]
write.csv(bz_df, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_pct_by_scenario_seagrass_cpu.csv")), row.names = F)
```

```{r CPU results for Mangroves in km2}
risk_df <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_km2_by_scenario_mangroves.csv")
risk_df$cpu <- as.factor(risk_df$cpu)
# select rows 1-9 = CPU 
target <- c('1','2','3','4','5','6','7','8','9')
bz_df <- risk_df[risk_df$cpu %in% target,] 
bz_df$CPU <- paste(bz_df$cpu,bz_df$cpu_name,sep= "-")
bz_df <- bz_df[, c(1:2,8,3:7)]
write.csv(bz_df, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_km2_by_scenario_mangroves_cpu.csv")), row.names = F)
```

```{r CPU results for Mangroves in pct}
risk_df <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_pct_by_scenario_mangroves.csv")
risk_df$cpu <- as.factor(risk_df$cpu)
# select rows 1-9 = CPU 
target <- c('1','2','3','4','5','6','7','8','9')
bz_df <- risk_df[risk_df$cpu %in% target,] 
bz_df$CPU <- paste(bz_df$cpu,bz_df$cpu_name,sep= "-")
bz_df <- bz_df[, c(1:2,8,3:7)]
write.csv(bz_df, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("risk_pct_by_scenario_mangroves_cpu.csv")), row.names = F)
```

We completed this section so we can clear our working environment

```{r Clear the working environment}
rm(list = ls(all.names=TRUE))
```


# F/ Calculate functional habitat at the Belize scale

We calculate the functional habitat for the entire country, for each habitat type:

```{r Calculate functional habitat for Coral}
habitat_risk <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_km2_by_scenario_corals_bz.csv")
habitat_risk$Risk <- as.factor(habitat_risk$Risk)
target <- c('No Risk','Low') 
risk_low <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_low$func_hab = risk_low$km2*1
target <- c('Medium') 
risk_med <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_med$func_hab <- (risk_med$km2)*0.5
target <- c('High') 
risk_hig <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_hig$func_hab <- (risk_hig$km2)*0
functional_hab <- rbind(risk_low, risk_med, risk_hig)
functional_hab_sum <- functional_hab %>% group_by(Year,cpu) %>% summarise(km2 = sum(func_hab))
functional_hab_sum -> functional_hab_sum_coral
write.csv(functional_hab_sum, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("functional_habitat_km2_by_scenario_corals_bz.csv")), row.names = F)
```

```{r Calculate functional habitat for Seagrass}
habitat_risk <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_km2_by_scenario_seagrass_bz.csv")
habitat_risk$Risk <- as.factor(habitat_risk$Risk)
target <- c('No Risk','Low') 
risk_low <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_low$func_hab = risk_low$km2*1
target <- c('Medium') 
risk_med <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_med$func_hab <- (risk_med$km2)*0.5
target <- c('High') 
risk_hig <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_hig$func_hab <- (risk_hig$km2)*0
functional_hab <- rbind(risk_low, risk_med, risk_hig)
functional_hab_sum <- functional_hab %>% group_by(Year,cpu) %>% summarise(km2 = sum(func_hab))
functional_hab_sum -> functional_hab_sum_seagrass
write.csv(functional_hab_sum, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("functional_habitat_km2_by_scenario_seagrass_bz.csv")), row.names = F)
```

```{r Calculate functional habitat for Mangroves}
habitat_risk <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_km2_by_scenario_mangroves_bz.csv")
habitat_risk$Risk <- as.factor(habitat_risk$Risk)
target <- c('No Risk','Low') 
risk_low <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_low$func_hab = risk_low$km2*1
target <- c('Medium') 
risk_med <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_med$func_hab <- (risk_med$km2)*0.5
target <- c('High') 
risk_hig <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_hig$func_hab <- (risk_hig$km2)*0
functional_hab <- rbind(risk_low, risk_med, risk_hig)
functional_hab_sum <- functional_hab %>% group_by(Year,cpu) %>% summarise(km2 = sum(func_hab))
functional_hab_sum -> functional_hab_sum_mangroves
write.csv(functional_hab_sum, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("functional_habitat_km2_by_scenario_mangroves_bz.csv")), row.names = F)
```

Last we combine the functiona habitat for each habitat into one database to create a barchart Refer to HRA_figure script)
```{r Combine the functional habitat for the 3 habitats into 1 database}
functional_hab_sum_coral$Habitat <- "Corals" 
functional_hab_sum_seagrass$Habitat <- "Seagrasses"
functional_hab_sum_mangroves$Habitat <- "Mangroves"
functional_hab_sum_bz <- rbind(functional_hab_sum_coral,functional_hab_sum_seagrass,functional_hab_sum_mangroves)
functional_hab_sum_bz <- functional_hab_sum_bz[, c(4,1,3)]
write.csv(functional_hab_sum_bz, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("functional_habitat_km2_by_scenario_bz.csv")), row.names = F)
```

We completed this section so we can clear our working environment

```{r Clear the working environment}
rm(list = ls(all.names=TRUE))
```

# G/ Calculate functional habitat at the Coastal Planning Unit scale

We calculate the functional habitat by coastal planning unit, for each habitat type:

```{r Calculate functional habitat for Coral}
habitat_risk <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_km2_by_scenario_corals_cpu.csv")
habitat_risk$Risk <- as.factor(habitat_risk$Risk)
target <- c('No Risk','Low') 
risk_low <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_low$func_hab = risk_low$km2*1
target <- c('Medium') 
risk_med <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_med$func_hab <- (risk_med$km2)*0.5
target <- c('High') 
risk_hig <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_hig$func_hab <- (risk_hig$km2)*0
functional_hab <- rbind(risk_low, risk_med, risk_hig)
functional_hab_sum <- functional_hab %>% group_by(Year,cpu,CPU,cpu_name) %>% summarise(km2 = sum(func_hab))
functional_hab_sum -> functional_hab_sum_coral
write.csv(functional_hab_sum, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("functional_habitat_km2_by_scenario_corals_cpu.csv")), row.names = F)
```

```{r Calculate functional habitat for Seagrass}
habitat_risk <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_km2_by_scenario_seagrass_cpu.csv")
habitat_risk$Risk <- as.factor(habitat_risk$Risk)
target <- c('No Risk','Low') 
risk_low <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_low$func_hab = risk_low$km2
target <- c('Medium') 
risk_med <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_med$func_hab <- (risk_med$km2)/2
target <- c('High') 
risk_hig <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_hig$func_hab <- (risk_hig$km2)*0
functional_hab <- rbind(risk_low, risk_med, risk_hig)
functional_hab_sum <- functional_hab %>% group_by(Year,cpu,CPU,cpu_name) %>% summarise(km2 = sum(func_hab))
functional_hab_sum -> functional_hab_sum_seagrass
write.csv(functional_hab_sum, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("functional_habitat_km2_by_scenario_seagrass_cpu.csv")), row.names = F)
```

```{r Calculate functional habitat for Mangroves}
habitat_risk <- read.csv("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats/risk_km2_by_scenario_mangroves_cpu.csv")
habitat_risk$Risk <- as.factor(habitat_risk$Risk)
target <- c('No Risk','Low') 
risk_low <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_low$func_hab = risk_low$km2
target <- c('Medium') 
risk_med <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_med$func_hab <- (risk_med$km2)/2
target <- c('High') 
risk_hig <- habitat_risk[habitat_risk$Risk %in% target,] 
risk_hig$func_hab <- (risk_hig$km2)*0
functional_hab <- rbind(risk_low, risk_med, risk_hig)
functional_hab_sum <- functional_hab %>% group_by(Year,cpu,CPU,cpu_name) %>% summarise(km2 = sum(func_hab))
functional_hab_sum -> functional_hab_sum_mangroves
write.csv(functional_hab_sum, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("functional_habitat_km2_by_scenario_mangroves_cpu.csv")), row.names = F)
```

Last we combine the functiona habitat for each habitat into one database to create a barchart Refer to HRA_figure script)
```{r Combine the functional habitat for the 3 habitats into 1 database}
functional_hab_sum_coral$Habitat <- "Corals" 
functional_hab_sum_seagrass$Habitat <- "Seagrasses"
functional_hab_sum_mangroves$Habitat <- "Mangroves"
functional_hab_sum_cpu <- rbind(functional_hab_sum_coral,functional_hab_sum_seagrass,functional_hab_sum_mangroves)
functional_hab_sum_cpu <- functional_hab_sum_cpu[, c(6,1:5)]
write.csv(functional_hab_sum_cpu, file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("functional_habitat_km2_by_scenario_cpu.csv")), row.names = F)
```

We completed this section so we can clear our working environment

```{r Clear the working environment}
rm(list = ls(all.names=TRUE))
```

# H/ Summarize the Habitat Risk results into bar charts:

Create bar chart habitat risk - Belize scale - Coral
```{r Belize scale - Coral habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_corals_bz.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1,6,11),]
hab_risk$Year <- factor(hab_risk$Year,
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                                levels = c("No Risk","Low", "Medium", "High"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=Risk, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Coral Habitat", x = "", y = bquote("Area "(km^2)), fill = "Risk Level:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_blank(), 
      axis.ticks.x = element_blank(),
      axis.text.x = element_blank(),
      axis.title.y = element_text(size = 12, face="bold"), 
      axis.text = element_text(size = 12, color = "black"),
      strip.text.x = element_text(size = 12),
      legend.title = element_text(colour="black", size=12, face="bold"),
      legend.text = element_text(colour="black", size=12),
      legend.position="bottom")
  plot_grid(ggbars + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_1_barplot_bz_hab_risk_corals.pdf")),
    width = 6, height = 5)
plot_grid(ggbars + scale_y_continuous(labels = scales::comma))
dev.off()
```

Create bar chart habitat risk - Belize scale - Seagrass 
```{r Belize scale - Seagrass habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_seagrass_bz.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1,6,11),]
hab_risk$Year <- factor(hab_risk$Year,
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,
                        levels = c("No Risk","Low", "Medium", "High"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=Risk, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Seagrass Habitat", x = "", y = bquote("Area "(km^2)), fill = "Risk Level:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_blank(), 
        axis.ticks.x = element_blank(),
        axis.text.x = element_blank(),
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_2_barplot_bz_hab_risk_seagrass.pdf")),
    width = 6, height = 5)
plot_grid(ggbars + scale_y_continuous(labels = scales::comma))
dev.off()
```

Create bar chart habitat risk - Belize scale - Mangroves
```{r Belize scale - Mangroves habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_mangroves_bz.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1,6,11),]
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                        levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                        levels = c("No Risk","Low", "Medium", "High"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=Risk, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Mangroves Habitat", x = "", y = bquote("Area "(km^2)), fill = "Risk Level:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_blank(), 
        axis.ticks.x = element_blank(),
        axis.text.x = element_blank(),
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_3_barplot_bz_hab_risk_mangroves.pdf")),
    width = 6, height = 5)
plot_grid(ggbars + scale_y_continuous(labels = scales::comma))
dev.off()
```

Create bar chart habitat risk - Coastal Planning Unit scale - Corals
```{r Coastal Planning Unit scale - Corals habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_corals_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("9-Southern Region","8-South Central Region","7-South Northern Region","6-Lighthouse Reef Atoll","5-Turneffe Atoll","4-Central Region","3-Caye Caulker","2-Ambergris Caye","1-Northern Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Coral Habitat", x = "Coastal Planning Units", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_4_barplot_cpu_hab_risk_corals.pdf")),
    width = 8, height = 5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #1 - Corals habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_corals_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #1 
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('1')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("1-Northern Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Coral Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_4_barplot_cpu_hab_risk_corals_1.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #2 - Corals habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_corals_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #2
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('2')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("2-Ambergris Caye"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Coral Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_4_barplot_cpu_hab_risk_corals_2.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #3 - Corals habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_corals_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #3
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('3')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("3-Caye Caulker"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Coral Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_4_barplot_cpu_hab_risk_corals_3.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #4 - Corals habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_corals_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #4
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('4')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("4-Central Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Coral Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_4_barplot_cpu_hab_risk_corals_4.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #5 - Corals habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_corals_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #5
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('5')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("5-Turneffe Atoll"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Coral Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_4_barplot_cpu_hab_risk_corals_5.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #6 - Corals habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_corals_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #6
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('6')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("6-Lighthouse Reef Atoll"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Coral Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_4_barplot_cpu_hab_risk_corals_6.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #7 - Corals habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_corals_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #7
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('7')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("7-South Northern Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Coral Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_4_barplot_cpu_hab_risk_corals_7.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #8 - Corals habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_corals_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #8
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('8')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("8-South Central Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Coral Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_4_barplot_cpu_hab_risk_corals_8.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #9 - Corals habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_corals_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #9
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('9')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("9-Southern Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Coral Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_4_barplot_cpu_hab_risk_corals_9.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

Create bar chart habitat risk - Coastal Planning scale - Seagrass
```{r Coastal Planning Unit scale - Seagrass habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_seagrass_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
hab_risk$Year <- factor(hab_risk$Year,
                        levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,
                        levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,
                          levels = c("9-Southern Region","8-South Central Region","7-South Northern Region","6-Lighthouse Reef Atoll","5-Turneffe Atoll","4-Central Region","3-Caye Caulker","2-Ambergris Caye","1-Northern Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Seagrass Habitat", x = "Coastal Planning Units", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_5_barplot_cpu_hab_risk_seagrass.pdf")),
    width = 8, height = 5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #1 - Seagrass habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_seagrass_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #1 
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('1')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("1-Northern Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Seagrass Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_5_barplot_cpu_hab_risk_seagrass_1.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #2 - Seagrass habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_seagrass_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #2
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('2')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("2-Ambergris Caye"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Seagrass Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_5_barplot_cpu_hab_risk_seagrass_2.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #3 - Seagrass habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_seagrass_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #3
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('3')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("3-Caye Caulker"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Seagrass Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_5_barplot_cpu_hab_risk_seagrass_3.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #4 - Seagrass habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_seagrass_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #4
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('4')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("4-Central Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Seagrass Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_5_barplot_cpu_hab_risk_seagrass_4.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #5 - Seagrass habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_seagrass_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #5
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('5')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("5-Turneffe Atoll"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Seagrass Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_5_barplot_cpu_hab_risk_seagrass_5.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #6 - Seagrass habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_seagrass_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #6
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('6')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("6-Lighthouse Reef Atoll"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Seagrass Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_5_barplot_cpu_hab_risk_seagrass_6.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #7 - Seagrass habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_seagrass_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #7
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('7')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("7-South Northern Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Seagrass Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_5_barplot_cpu_hab_risk_seagrass_7.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #8 - Seagrass habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_seagrass_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #8
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('8')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("8-South Central Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Seagrass Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_5_barplot_cpu_hab_risk_seagrass_8.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #9 - Seagrass habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_seagrass_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #9
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('9')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("9-Southern Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Seagrass Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_5_barplot_cpu_hab_risk_seagrass_9.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

Create bar chart habitat risk - Coastal Planning scale - Mangroves
```{r Coastal Planning Unit scale - Mangroves habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_mangroves_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
hab_risk$Year <- factor(hab_risk$Year,
                        levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  
                        levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,
                          levels = c("9-Southern Region","8-South Central Region","7-South Northern Region","6-Lighthouse Reef Atoll","5-Turneffe Atoll","4-Central Region","3-Caye Caulker","2-Ambergris Caye","1-Northern Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Mangroves Habitat", x = "Coastal Planning Units", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_6_barplot_cpu_hab_risk_mangroves.pdf")),
    width = 8, height = 5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #1 - Mangroves habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_mangroves_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #1 
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('1')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("1-Northern Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Mangrove Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_6_barplot_cpu_hab_risk_mangroves_1.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #2 - Mangroves habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_mangroves_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #2
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('2')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("2-Ambergris Caye"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Mangrove Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_6_barplot_cpu_hab_risk_mangroves_2.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #3 - Mangroves habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_mangroves_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #3
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('3')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("3-Caye Caulker"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Mangrove Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_6_barplot_cpu_hab_risk_mangroves_3.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #4 - Mangroves habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_mangroves_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #4
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('4')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("4-Central Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Mangrove Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_6_barplot_cpu_hab_risk_mangroves_4.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #5 - Mangroves habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_mangroves_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #5
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('5')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("5-Turneffe Atoll"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Mangrove Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_6_barplot_cpu_hab_risk_mangroves_5.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #6 - Mangroves habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_mangroves_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #6
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('6')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("6-Lighthouse Reef Atoll"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Mangrove Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_6_barplot_cpu_hab_risk_mangroves_6.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #7 - Mangroves habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_mangroves_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #7
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('7')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("7-South Northern Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Mangrove Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_6_barplot_cpu_hab_risk_mangroves_7.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #8 - Mangroves habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_mangroves_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #8
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('8')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("8-South Central Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Mangrove Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_6_barplot_cpu_hab_risk_mangroves_8.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

```{r Coastal Planning Unit scale #9 - Mangroves habitat risk bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_risk <- read.csv("risk_km2_by_scenario_mangroves_cpu.csv")
names(hab_risk)
hab_risk <- hab_risk[-c(1:9,46:54,91:99),]
# select rows where CPU = #9
hab_risk$cpu <- as.factor(hab_risk$cpu)
target <- c('9')
hab_risk <- hab_risk[hab_risk$cpu %in% target,] 
hab_risk$Year <- factor(hab_risk$Year,  # Change ordering manually
                          levels = c("2016", "2020", "2025"))
hab_risk$Risk <- factor(hab_risk$Risk,  # Change ordering manually
                          levels = c("High", "Medium", "Low","No Risk"))
hab_risk$CPU <- factor(hab_risk$CPU,  # Change ordering manually
                          levels = c("9-Southern Region"))
riskycols <- c("grey","#0066CC", "#FFCC00", "red3")
names(riskycols) <- c("No Risk","Low", "Medium", "High")
ggbars <- ggplot(hab_risk) +
  geom_bar(aes(x=CPU, y=km2, fill=Risk), position="dodge", stat="identity") +
  scale_fill_manual(values=riskycols) +
  labs(title = "Mangrove Habitat", x = "Coastal Planning Unit", y = bquote("Area "(km^2)), fill = "Risk:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_6_barplot_cpu_hab_risk_mangroves_9.pdf")),
    width = 8.5, height = 2.5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

# I/ Summarize the Functional Habitat results into bar charts:

Create bar chart functional habitat - Belize scale
```{r Belize scale - Functional habitats bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_functional <- read.csv("functional_habitat_km2_by_scenario_bz.csv")
names(hab_functional)
hab_functional$Habitat <- factor(hab_functional$Habitat,
                              levels = c("Corals", "Mangroves", "Seagrasses"))
hab_functional$Year <- factor(hab_functional$Year,
                        levels = c("2016", "2020", "2025"))
hab_functional$km2 <- round(hab_functional$km2)
habcols <- c("coral", "black", "darkgreen")
names(habcols) <- c("Corals", "Mangroves", "Seagrasses")
ggbars <- ggplot(hab_functional) +
  geom_bar(aes(x=Habitat, y=km2, fill=Habitat), position="dodge", stat="identity") +
  scale_fill_manual(values=habcols) +
  labs(title = "Functional Habitat", x = "", y = bquote("Area "(km^2)), fill = "Habitats:") +
  facet_wrap("Year") +
  geom_text(data=hab_functional,aes(x=Habitat,y=km2,label=km2), 
            position=position_dodge(width=0.9),vjust=-0.15) +
  theme_bw() +
  theme(axis.title.x = element_blank(), 
        axis.ticks.x = element_blank(),
        axis.text.x = element_blank(),
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text.y = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_7_barplot_bz_hab_functional.pdf")),
    width = 5, height = 4.5)
plot_grid(ggbars + scale_y_continuous(labels = scales::comma))
dev.off()
```

Create bar chart functional habitat - Coastal Planning scale
```{r Coastal planning unit scale - Functional habitats bar chart}
setwd("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats")
hab_functional <- read.csv("functional_habitat_km2_by_scenario_cpu.csv")
names(hab_functional)
hab_functional$Habitat <- factor(hab_functional$Habitat,
                                 levels = c("Corals", "Mangroves", "Seagrasses"))
hab_functional$Year <- factor(hab_functional$Year,
                              levels = c("2016", "2020", "2025"))
hab_functional$CPU <- factor(hab_functional$CPU,
                          levels = c("9-Southern Region","8-South Central Region","7-South Northern Region","6-Lighthouse Reef Atoll","5-Turneffe Atoll","4-Central Region","3-Caye Caulker","2-Ambergris Caye","1-Northern Region"))
habcols <- c("coral", "black", "darkgreen")
names(habcols) <- c("Corals", "Mangroves", "Seagrasses")
ggbars <- ggplot(hab_functional) +
  geom_bar(aes(x=CPU, y=km2, fill=Habitat), position="dodge", stat="identity") +
  scale_fill_manual(values=habcols) +
  labs(title = "Functional Habitat", x = "Coastal Planning Units", y = bquote("Area "(km^2)), fill = "Habitats:") +
  facet_wrap("Year") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12, face="bold"), 
        axis.title.y = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 12, color = "black"),
        strip.text.x = element_text(size = 12),
        legend.title = element_text(colour="black", size=12, face="bold"),
        legend.text = element_text(colour="black", size=12),
        legend.position="bottom")
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
pdf(file.path("E:/GreenFin/01_hra_model/5_hra_outputs/2016_habitats", paste("Fig_8_barplot_cpu_hab_functional.pdf")),
    width = 8, height = 5)
plot_grid(ggbars + coord_flip() + scale_y_continuous(labels = scales::comma))
dev.off()
```

